id: 57ab441ef9d4496dbade782d4f6aff4e
parent_id: 
item_type: 1
item_id: 6d6212ec41e54f0094522c03d70b4056
item_updated_time: 1581793567114
title_diff: "@@ -0,0 +1,36 @@\n+Day 3 : Terminal 101 - Student Guide\n"
body_diff: "@@ -0,0 +1,22564 @@\n+%0A# Student Guide%0A%0A## Terminal 101 - Day 3: Stick to the Script%0A%0A### Overview%0A%0AIn today's class, you will further develop your command line skills by learning how to use text processing and text editing to develop your own command line script.%0A %0A### Class Objectives%0A%0ABy the end of this class, you will be able to:%0A%0A* Define three benefits of text processing programs over programming languages for a security professional.%0A* Use %60sed%60 to make substitutions to a file.%0A* Use %60awk%60 to isolate data points from a complex log file.%0A* Edit contents of a file using %60nano%60.%0A* Design an IP lookup shell script by passing arguments.%0A%0A%0A### Slideshow%0A%0A- The lesson slides are available on Google Drive here: %5BTerminal 101 Day 3 Slides%5D().%0A%0A%0A- **Note:** Editing access is not available for this document. If you wish to modify the slides, please create a copy by navigating to File %3E %22Make a copy...%22.%0A%0A%0A-------%0A%0A### 01. Class Introduction%0A%0ABefore diving into the next set of commands, let's review what we've covered so far. %0A%0A**Command Options and Man Pages**%0A%0A- Commands can have their default behavior modified using **options**.%0A- Command options can have their own arguments called **parameters**.%0A- **Man pages** are documentation that exist within the terminal containing command syntax, options, and parameters.%0A- %60man%60 followed by a command will display the documentation for that specific command.%0A%0A**Searching for Directories, Files, and Data Within Files**%0A%0A- The %60find%60 command is used to find directories or files.%0A  - %60-type d%60 is the option and parameter for finding directories.%0A  - %60-type f%60 is the option and parameter for finding a file.%0A%0A- The %60grep%60 command is used to find a data point within a file.%0A%0A- **Wildcards**, indicated with a %60*%60, can assist %60grep%60 and %60find%60 by:%0A%0A     - Looking through multiple files. For example: %60*.txt%60.%0A     - Looking for part of a data point. For example: %60*login*%60.%0A  %0A**Counting Data and Piping**%0A%0A- The %60wc%60 command can be used for counting files, lines, and words.%0A%0A- Pipes, which are indicated by %60%7C%60, are used to combine multiple commands.%0A%0A- Pipes take the output from the command on the left and apply it to the new command on the right.%0A  %0A%0A### 02. Activity: Warm-Up Activity%0A%0A- %5BActivity File: Warm-Up Activity%5D(Activities/warmup/unsolved/readme.md)%0A- %5BDirectories/Files: Warm-Up Activity%5D(Resources/warmup.zip)%0A%0A%0A### 03. Activity Review: Warm-Up Activity%0A%0A - %5BSolution Guide: Warm-Up Activity%5D(Activities/warmup/solved/readme.md)%0A### 04. Introduction to Text Processing%0A%0ASecurity professionals often face the following challenges:%0A%0A - They work with many forms of data such as application logs, server logs, server files, configuration files, and raw code.%0A %0A - Many of these forms of data are complex, large, and difficult to analyze in their raw form.%0A %0A    For example, take a look at the following web server log file: %0A %0A !%5Bcomplex log file with many lines of code%5D(images/complexlogs.png)%0A %0A- These complex data files can be difficult for anyone to analyze. %0A%0A- Embedded within these complex and large files are **data points** that can help security analysts research **security incidents**, such as:%0A    - Dates%0A    - Usernames%0A    - Phone numbers%0A%0A- These data points can help security professionals to:%0A%0A  - **Isolate attack signatures.**%0A    %0A     For example: An attacker might use a specific username to launch their attack. Finding this data point will assist with isolating out the username tied to an attacker.%0A%0A  - **Identify attack vectors.**%0A    %0A     For example: An attacker might launch an attack through a field on a login page. Finding this data point will assist with identifying the field being used for the attack.%0A%0A  - **Identify timing of attacks.**%0A    %0A     For example: An attacker might launch their attack at exactly midnight every night. Finding this data point can help isolate out the timing of the attack.%0A%0A%0AWe have to take these large and complex files and isolate the data points that are needed to complete tasks. This can be accomplished with **text processing commands**.%0A%0A#### Text Processing Commands%0A%0A**Text processing commands** are command languages used to manipulate text and simplify complex data.%0A%0A  - Text processing commands have many capabilities to simplify working with complex data, such as:%0A    - Substituting text.%0A    - Filtering lines of text.%0A    - Delimiting text.%0A%0A  - Multiple text processing commands are already built-in to the terminal, such as %60cut%60, %60awk%60 and %60sed%60.%0A  %0AOther command languages can also manipulate text, such as Python and C++. However, these languages are designed more for **programming** and are primarily used to run web applications.  %0A%0AText processing provides the following three benefits over programming languages:%0A%0A - **Simplicity**: Text processing is simpler and easier to learn than programming languages.%0A%0A - **Convenience**: Most text processing commands are pre-installed in terminals, unlike many programming languages.%0A %0A - **Compatibility**:  Text processing commands can easily be added together to complete more advanced tasks. This is much more challenging to do with programming languages.%0A%0AThis lesson we will be focusing on the powerful text processing utilities of %60awk%60 and %60sed%60.  %0A%0A### 05. Introduction to %60sed%60%0A%0AWe just covered how security professionals spend a lot of time working with complex log files.  One source of added time and complication is the need to analyze and consolidate complex data from different sources.%0A%0A- For example:%0A%0A    - You need to analyze login activities across two different applications.%0A%0A    - One application labels logins as %22LOGGED IN%22 while the other labels them as %22ACCESS ACCEPTED.%22 %0A%0A    - The challenge is to replace all the strings of %60ACCESS ACCEPTED%60 with %60LOGGED IN%60 so the data is consistent when analyzing the datasets together.%0A     %0AWe can use the text processing command %60sed%60 to accomplish this task. %0A%0A  - %60sed%60 stands for _**s**tream **ed**itor_.%0A%0A  - This means that it reads and edits text, line-by-line, from an input stream.%0A%0A  - An *input stream* is a string of all characters in a text file.%0A%0A  - It's called a *stream* because %60sed%60 reads the file from top-to-bottom, line-by-line, and only reads each line once.%0A%0AIn other words, %60sed%60 is a utility that works from the command line to modify text using an easy and compact coding language.%0A%0A- While %60sed%60 has multiple capabilities, we will be learning the most basic %60sed%60 capability: **string replacement**.%0A%0A#### Using %60sed%60 for String Replacement%0A%0A**Note**: String replacement is synonymous with string substitution%E2%80%94 similar to the Windows _find and replace_ feature. %0A   %0AWe will walk through a simple %60sed%60 command to create a basic string replacement.%0A%0A  - We will be doing the following string replacement: %0A      %0A     %60The Dog Chased the Ball%60 will become %60 The Dog Chased the Cat%60   %0A      %0A  - We will accomplish this by using %60sed%60 to replace %60Ball%60 with %60Cat%60.    %0A%0A#### %60sed%60 Demonstration%0A%0A1. Access the %60/instructor_day3/sed_demonstration/%60 directory: %0A%0A    %60cd /instructor_day3/sed_demonstration/%60%0A%0A2. Within this directory is a file called %60sed.txt%60.%0A%0A3. Show the contents of the file by running  %60cat sed.txt%60.%0A%0A      - This displays the only line in the file:   %0A      %0A        - %60The Dog Chased the Ball%60%0A            %0A4. Next we will use %60sed%60 to replace the word %22Ball%22  with %22Cat%22:%0A%0A    %60cat sed.txt %7C sed s/Ball/Cat/%60%0A              %0A    - The syntax is:%0A%0A      %60cat (file name) (pipe) sed s/(old value)/(replacement value)/%60%0A           %0A5. Run the command. It replaces the word %60Ball%60 with %60Cat%60 with the following result:%0A%0A   - %60The Dog Chased the Cat%60%0A           %0A%0A### Demo Summary%0A%0AWe covered the following concepts: %0A%0A  - %60sed%60 is a text processing utility that can assist security professionals with analyzing data.%0A%0A  - The most basic %60sed%60 capability is **string replacement**. This can increase consistency across separate data sources, which can assist in research.%0A%0A  - The basic syntax of string replacement is %60sed   s/(old value)/(replacement value)/%60.%0A%0A%0A### 06. Activity: Using %60sed%60%0A%0A- %5BActivity File: Using %60sed%60%5D(Activities/sed_activity/unsolved/readme.md)%0A- %5BDirectories/Files: Using %60sed%60%5D(Resources/learning_sed.zip)%0A%0A%0A### 07. Activity Review: Using %60sed%60%0A%0A- %5BSolution Guide: Using %60sed%60 Activity%5D(Activities/sed_activity/solved/readme.md)%0A%0A### 08. Introduction to %60awk%60 %0A%0AWhen working with data, you'll often often need to obtain specific data points within complex log files.%0A%0A- For example: %0A  %0A  - You have a log file that contains city, state, and country fields, separated out by commas. However, for our analysis, we only need the **states** from the log file. %0A  %0A  - In other words, our log record contains records like %22Atlanta, Georgia, USA,%22 but we only need %22Georgia.%22 %0A%0AWe can technically use %60sed%60 to perform the task with the following command:%0A%0A   %60sed 's/%5E.*%5C(,.*,%5C).*$/%5C1/' %7C sed 's/,//g'%60%0A%0A- While %60sed%60 can technically perform this task, it is a complicated set of code that takes time to compose.  %0A%0AFortunately, there is another text processing tool called %60awk%60 that allows us to perform this task more efficiently.%0A%0A - Like %60sed%60, %60awk%60 is designed for text processing, but is primarily used for data extraction and reporting from streams of text.%0A%0A - %60awk%60 can separate out fields in a stream of text and isolate the specific fields needed.%0A%0AWe'll demonstrate how to isolate the State field from the above example by using %60awk%60.%0A%0A#### %60awk%60 Simple Demonstration%0A%0A%0A1. Access the %60/instructor_day3/awk_demonstration/%60 directory:%0A%0A    %60cd /instructor_day3/awk_demonstration/%60%0A%0A2. Within this directory is a file called %60awk.txt%60.%0A%0A3. Show the contents of the file by running %60cat awk.txt%60.%0A%0A    - This displays the only line in the file:   %0A      %0A      - %60Atlanta, Georgia, USA%60%0A        %0A4. To use %60awk%60 to only display the state, Georgia, we will run the following:        %0A            %0A    %60cat awk.txt %7C awk -F, '%7Bprint $2%7D'%60%0A%0A   -  The syntax (after the pipe):  %60awk -F(delimiter)  '%7Bprint $(field_number)%7D' %60  %0A     %0A      - %60awk%60: Indicator telling your operating system to run the %60awk%60 command.%0A             %0A      - %60-F,%60: Option for doing field separation with %60awk%60.%0A          %0A          - The value that comes right after %60-F%60 is the parameter signifying how the file separates out the data points. In the example, the parameter is a comma (%60,%60).%0A          %0A          - This parameter is also known as the **delimiter**. %0A          %0A          - **Note:** The parameter needs to come directly after the %60-F%60, with no spaces.%0A             %0A    - %60%7Bprint  $2%7D'%60 %0A    %0A      - This indicates %60awk%60 is printing the second field, after the fields have been separated by a comma.%0A%0A      - The %60$%60 is included before the number to indicate the field.  %0A%0A      - Multiple fields can be added, with a comma between each. %0A%0A      - The required format must have single quotes (%60''%60) and curly brackets (%60%7B%7D%60) around the print function.%0A             %0A5. Run the command.%0A%0A    - We were able to separate out %60Atlanta, Georgia, USA%60 by commas using %60awk%60 and only print out the second field, which contained the value %60Georgia%60.%0A%0A    - This is a much simpler set of code then what was required by %60sed%60.%0A%0A%0AThis was a very basic example, and security professionals often need to isolate out multiple fields from complex log files. Now we will do another more challenging demonstration to illustrate how %60awk%60 can be used to assist with a security incident.%0A%0A### %60awk%60 Demonstration for a Security Incident%0A%0AIn this scenario, you are security analysts at ACME Corp, which has just experienced an attack of a high volume of network requests. You have been provided the logs of these network requests.%0A%0AYou are tasked with isolating out the IP addresses and time or requests from these logs to determine which IP address is appearing most frequently. This IP likely belongs to the attacker.%0A  %0A1. Access the %60/instructor_day3/awk_demonstration/%60 directory. Run:%0A    %0A    %60cd /instructor_day3/awk_demonstration/%60%0A%0A2. Preview the log file, called %60access_logs%60. Run: %0A%0A    %60more access_logs%60              %0A     %0A3.  Next, we need to analyze the data of the log file to determine how to build our %60awk%60 command.%0A%0A    -  Note each of the items below on the log file:%0A%0A        - The fields are separated out by spaces, so a space will be used as a field separator.%0A%0A        - When we separate out the fields by spaces,  Time is in the second field, so we will need to print out the second field first.%0A%0A        - The IP Address is in the first field, so we will need to print this field after Time. %0A   %0A5. Type the following %60awk%60 command to see how this will be accomplished:%0A %0A      %60cat access_logs%7C awk -F%22 %22  '%7Bprint $2, $1%7D'%60%0A             %0A %0A   - The first part of the %60awk%60 syntax (after the pipe):  %60awk -F%22 %22%60%0A     %0A     - This instructs the operating system to run the %60awk%60 command of field separation.%0A%0A     - In this example, one space is the delimiter.%0A%0A        To indicate that we want to separate the fields by spaces, we place once space between two double quotes (%60%22 %22%60).%0A             %0A   - The second part of the %60awk%60 syntax: %60%7Bprint $2, $1%7D%60%0A     %0A      - This command will print out the second and first fields, in that order.  %0A              %0A6. Run the command and notice how %60awk%60 is able to take a complex log file and parse it out to show only the fields needed: Time and IP Address.%0A%0A    -  In this result, the top reoccurring IP,  %6041.33.233.87%60,  is easy to detect. This is likely IP address of the attacker.%0A%0A    - Identifying an IP address of an attacker can assist a security professional with determining what IP address should be blocked from the network to prevent future attacks.%0A%0A   %0A ### %60awk%60 Summary  %0A %0A Review the following concepts:%0A%0A  - %60awk%60 is a text processing utility like %60sed%60, but is more robust, as it can separate out fields with simple code.%0A%0A  - %60awk%60 can assist security professionals by isolating specific data points, like IP addresses, to assist with determining what IP addresses should be blocked.%0A%0A  - The basic syntax of field separation with %60awk%60:  %0A  %0A    %60awk -F(delimiter)  '%7Bprint $(field_number)%7D' %60  %0A%0A%0A### 09.  Activity: Using %60awk%60 Activity %0A- %5BActivity File: Using %60awk%60 %5D(Activities/awk_activity/unsolved/readme.md)%0A%0A%0A### 10. Activity Review: Using %60awk%60%0A%0A%0A- %5BSolution Guide: Using %60awk%60%5D(Activities/awk_activity/solved/readme.md)%0A%0A### 11. Break %0A%0A### 12. Introduction to Shell Scripting%0A%0A%0AAs IT and security professionals, we are required to complete security tasks that involve multiple subsequent commands.%0A%0A  - For example: We might be tasked with cleaning up space in a directory because log files are taking up too much space%0A  %0A  - To complete these tasks, we would need to run the following  three separate commands, in order:%0A    1. %60cd%60 to navigate to the directory containing log files. %0A%0A    2. %60zip%60 to compress the files.%0A      %0A       - %60zip%60 commands will be covered in more detail in a future lesson.%0A%0A    3. %60mv%60 move the new zip file into an archive folder.%0A    %0ARather than run each of these activities separately, we can **script** them together, which allows the commands to be run in order using a single command. %0A%0AWriting scripts, or **scripting**,  provides the following benefits to IT and security professionals:%0A %0A   - Running multiple commands with a single script can improve the **speed** of tasks.%0A%0A   - Having a single script that runs multiple commands can improve the **consistency** of task results.%0A%0A   - Scripts can be provided to other users for **reusability**, meaning the exact same tasks can be completed by someone unfamiliar with the individual commands necessary to complete them.%0A%0AIn the terminal, we will focus on a specific type of scripting known as  **shell scripting**.%0A  %0A  - **Shell** is a terminal program that assists in the interaction between the user and the terminal.%0A  %0A     - There are many shells available in the terminal, such as %60sh%60, %60bash%60, %60zsh%60, and %60csh%60.%0A  %0A  - **Shell scripting** is a way of using these shell programs to automate tasks in the form of a collection of commands.%0A   %0AHow **shell scripts** are designed: %0A   %0A   - For the above example, a single shell script could be called %60diskcleanup.sh%60.%0A   %0A     - The %60.sh%60 is a required extension to make the shell script executable.%0A   %0A   - Within %60diskcleanup.sh %60 are the three commands in the order they need to be run, from the top down, one line per command:%0A   %0A      -  %60cd log_directory%60  %0A       -  %60zip logs* logfiles.zip%60  %0A       -  %60mv logfiles.zip ./archive_directory%60%0A   %0A   - To execute the shell script, we'd only need to run this single command:%0A      %0A     %60sh diskcleanup.sh%60%0A   %0A   - Running that single command would execute all the three commands inside of the script in order.%0A     %0A   %0AHowever, before we start writing our own scripts, we need to learn how to write into a file to add in our commands.   %0A%0A%0A### 13. Writing and Editing Files%0A%0AText editors are an efficient tool used to create and edit files with data inside them.%0A%0A- **Text editors** are command line utilities that edit plain text.%0A%0A- IT and security professionals can use text editors to build scripts and create documentation, reports or files of any type. %0A%0A- You are probably familiar with a type of text editor: Notepad in Windows.%0A%0A- Common text editors available within the terminal are: %60nano%60, %60vi%60, %60vim%60, and %60emacs%60.%0A%0A- Text editors can be used to create new files or edit existing files.%0A%0AWe will be completing a file editing demonstration with the text editor **Nano**, as this is the simplest one to learn and available on most terminals.%0A%0AWe will use Nano to create a simple shell script that contains the two following commands:%0A%0A   - %60mkdir new_directory%60%0A   - %60cd new_directory%60%0A   %0A%0A### Building a Shell Script Demonstration%0A%0A1.  Create a %60nano_demonstration%60 directory:%0A%0A    %60mkdir nano_demonstration%60 %0A2. Access the %60/instructor_day3/nano_demonstration/ directory%60:%0A%0A    %60cd nano_demonstration%60         %0A2. To create a new script called %60myfirstscript.sh%60 with Nano,  run:%0A%0A    %60nano myfirstscript.sh%60%0A     %0A   - The syntax is simply: %0A   %0A      %60nano %3Cnew file name%3E%60%0A   %0A-   If the file already exists, it will take us to edit that previously existing file.%0A%0A4.  Run the command %60nano myfirstscript.sh%60 and see that this takes you to an editing window within the terminal.%0A%0A    !%5Bediting window in terminal%5D(images/nano_screenshot.png)%0A%0A     This program is similar to Notepad in Windows, where we can edit the file as needed.%0A%0A6.  Type the first command on the first line:%0A    %0A      %60mkdir scripts%60%0A      %0A7. Enter the second command on the second line:%0A%0A      %60mv myfirstscript.sh scripts%60%0A      %0A8. Next, we need to save the changes in this file. Hold the %60Ctrl%60 key and %60O%60 at the same time.%0A      %0A   It will confirm the name of the file:  %60myfirstscript.sh%60%0A%0A      - Press %60Enter%60 to keep this file name.%0A      %0A   This created a shell script file called %60myfirstscript.sh%60.%0A%0A11. In order to run this new shell script, run the following command:%0A%0A      %60sh myfirstscript.sh%60%0A        %0A    - This command made a directory called %60new_directory%60 and placed your script file into it.%0A%0A13. Run the %60ls new_directory/%60 command to confirm this took place. %0A%0A #### File Writing and Editing Summary  %0A%0A  - **Text editors** are command line utilities that are used to create or edit plain text files.%0A%0A  - Nano is an easy-to-use text editor that is available in most terminals, and is good for creating shell scripts.%0A%0A%0A### 14. Activity: My First Shell Script %0A%0A- %5BActivity File: My First Shell Script%5D(Activities/shell_scripting/unsolved/readme.md)%0A- %5BDirectories/Files: My First Shell Script%5D(Resources/first_shell_script.zip)%0A%0A### 15. Activity Review: My First Shell Script %0A%0A- %5BSolution Guide: My First Shell Script%5D(Activities/shell_scripting/solved/readme.md)%0A%0A### 16. Passing Arguments %0A%0AThe script we just created will run the exact same process each time it is executed. However, there may be times we'll need to change a single value in a script.%0A %0A- For example: A security analyst may need to run the cleanup shell script we just created, but only need it to zip up a certain file date. %0A%0A  - If we need to zip up files named %60logs0519%60, we need to change one command in the script:%0A%0A    %60zip logs* logfiles.zip%60  %0A%0A    to%0A%0A    %60zip logs0519 logfiles.zip%60   %0A      %0A- Rather than manually edit the script to make this change each time the script is run, we can add a **passing argument**.%0A%0A### Passing a Single Argument%0A%0AHow to pass a single argument in a shell script:%0A%0A  - You can add an argument to pass into a script by placing the argument after the script name.%0A%0A    - For the above example, we can run:%0A     %0A      %60sh diskcleanup.sh  0519%60%0A     %0A    - The syntax is: %60sh   shellscript   Argument1%60.%0A%0A  - To pass the %600519%60 into the script, we have to add a %60$1%60 indicating where the first argument, %600519%60, will be passed.%0A%0A      - We would change:%0A%0A          %60zip logs* logfiles.zip%60%0A                %0A          to%0A        %0A        %60zip logs$1 logfiles.zip%60  %0A      %0A      - This way, when the script %60sh diskcleanup.sh  0519%60 runs, the command will be changed to:%0A      %0A        %60zip logs0519 logfiles.zip%60%0A   %0A### Adding Multiple Arguments   %0A      %0A  - Additional arguments can be added with the following syntax:%0A     %0A    %60sh   shellscript   Argument1 Argument2 Argument3%60%0A    %0A    - For example:%0A%0A       %60sh diskcleanup.sh  0519  backupfolder%60%0A  %0A  - Within the script, the arguments would be represented by:   %0A       - Argument1 = %60$1%60%0A       - Argument2 = %60$2%60%0A       - Argument3 = %60$3%60%0A       %0A ### Passing Arguments summary  %0A %0A Review the following concepts:%0A%0A  - Some scripts have to be slightly modified each time they are run. This can be simplified by **passing arguments**.%0A%0A  - When a script is run, you can add an argument or multiple arguments to pass into a script simply by placing the argument after the script name.%0A%0A  - Within the script itself, an argument or arguments can be represented by a %60$1%60 for the first argument, and %60$2%60 for the second argument, and so on.%0A%0A       %0A%0A### 17. Activity: Building an IP Lookup Tool %0A%0A- %5BActivity File: Building an IP Lookup Tool%5D(Activities/ip_lookup_activity/unsolved/readme.md)%0A%0A%0A%0A### 18. Activity Review: Building an IP Lookup Tool%0A%0A- %5BSolution Guide: Building an IP Lookup Tool%5D(Activities/ip_lookup_activity/solved/readme.md)%0A%0A-------%0A%0A## Copyright%0A%0ATrilogy Education Services %C2%A9 2020. All Rights Reserved.%0A\n"
metadata_diff: {"new":{"id":"6d6212ec41e54f0094522c03d70b4056","parent_id":"1b92165e8b8d4536889d08f2ece5004c","latitude":"0.00000000","longitude":"0.00000000","altitude":"0.0000","author":"","source_url":"","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":0,"markup_language":1,"is_shared":0},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2020-02-15T19:12:49.411Z
created_time: 2020-02-15T19:12:49.411Z
type_: 13